% Some notes / rules:
% - Things marked \apw{} are APW's requests for Katie
% - Things marked \todo{} can be addressed by anyone

\documentclass[twocolumn]{aastex631}

% Packages
\usepackage{microtype}  % ALWAYS!
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{multirow}

\definecolor{pink}{RGB}{232,132,161}
\newcommand{\kc}[1]{\textcolor{pink}{\textbf{#1}} }

\newcommand{\mlg}{\ensuremath{M_{\rm LG}}}
\newcommand{\mmto}{\ensuremath{M_{\rm M31}}}
\newcommand{\mmw}{\ensuremath{M_{\rm MW}}}
\newcommand{\vtan}{\ensuremath{v_\textrm{tan}}}
\newcommand{\vrad}{\ensuremath{v_\textrm{rad}}}
\newcommand{\mud}{\ensuremath{\mu_\delta}}
\newcommand{\mua}{\ensuremath{\mu_\alpha^*}}
\newcommand{\bov}{\ensuremath{\boldsymbol{v}}}
\newcommand{\pos}[2]{\ensuremath{\boldsymbol{x}_{\rm #1 \to #2}}}
\newcommand{\vel}[2]{\ensuremath{\bov_{\rm #1 \to #2}}}
\newcommand{\mwbary}{\ensuremath{\textrm{MW}_\textrm{bary}}}
\newcommand{\mwouter}{\ensuremath{\textrm{MW}_\textrm{outer}}}
\newcommand{\mwdisk}{\ensuremath{\textrm{MW}_\textrm{disk}}}

% Style tweaks
% \renewcommand{\twocolumngrid}{\onecolumngrid}
% \setlength{\parindent}{1.1\baselineskip}
% \sloppy\sloppypar\raggedbottom\frenchspacing

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\shorttitle{Updated Local Group Mass from Timing Argument}
\shortauthors{Chamberlain, Price-Whelan et al.}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\graphicspath{{./}{figures/}}
\input{math_definitions.tex}

% Affiliations
\newcommand{\affuofa}{University of Arizona, 933 N. Cherry Ave,
    Tucson, AZ 85721, USA}
\newcommand{\affcca}{Center for Computational Astrophysics, Flatiron Institute,
    Simons Foundation, 162 Fifth Avenue, New York, NY 10010, USA}

%% This is the end of the preamble.  Indicate the beginning of the
%% manuscript itself with \begin{document}.

\begin{document}

\title{
    A timing argument mass for the Local Group accounting for the
    Milky Way--LMC reflex motion
}

\author[0000-0001-8765-8670]{Katie~Chamberlain}
\affiliation{\affuofa}
\affiliation{\affcca}

\author[0000-0003-0872-7098]{Adrian~M.~Price-Whelan}
\affiliation{\affcca}

% TODO: Alphabetical ok?
\author{Gurtina Besla}
\affiliation{\affuofa}

\author{Emily Cunningham}
\affiliation{\affcca}

\author{Nicol\'{a}s Garavito-Camargo}
\affiliation{\affcca}

\author{Jorge Pe\~{n}arrubia}
\affiliation{TODO: Edinburgh}

\author{Michael Petersen}
\affiliation{TODO: Barcelona}

% TODO: Any other authors??

\begin{abstract}
    % \textbf{Context}
    The total mass of the Local Group (LG) is a fundamental quantity that
    enables interpretation of the orbits of its constituent galaxies and is
    needed to place it in a cosmological context.
    One of the few methods that enables inferring the total mass directly is the
    ``Timing Argument,'' which models the relative orbit of the Milky Way (MW)
    and M31.
    However, recent models of stellar tracers in the outer MW halo have shown
    that the inner MW and disk are moving with respect to the outer halo, thus
    biasing past Timing Argument measurements that do not account for this
    motion.
    % \textbf{Aims}
    % \textbf{Methods}
    Here, we measure the total LG mass using a Timing Argument model that
    incorporates this measured ``travel velocity'' of the MW disk using several
    compilations of recent kinematic measurements of M31.
    % \textbf{Results}
    We generally find lower LG masses than past Timing Argument results and
    measure a consistent (between datasets) total mass of
    $4.5^{+0.8}_{-0.6}\times 10^{12}~\Msun$ using the travel velocity $32 \pm
    4~\kms$ measured in \citet{Petersen2021}.
    However, further measurements of this travel velocity with more distant
    tracers could yield even larger values, which would further decrease the
    inferred LG mass.
    Future data releases from \emph{Gaia} will lead to more precise measurements
    of M31's proper motion that will improve the precision of Timing Argument
    mass constraints by a factor of $\sim2$.
    % \textbf{Conclusions}
    The Timing Argument remains one of the only ways to measure the Local Group
    mass independent of the masses of the individual component galaxies, but
    it is clear that the effect of the LMC must be accounted for when using
    these techniques.
    \apw{I think we need a better concluding sentence!}

\end{abstract}

\section{Introduction}
\label{sec:intro}
% \textbf{Importance of local group mass and measuring it}
The total mass of the Local Group is a fundamental quantity in many local
cosmological and Milky Way (MW) applications.
For example, it is used to identify analogous halos in cosmological simulations
and thus allows comparing host galaxy and satellite galaxy number counts and
properties \citep{Patel2017a, Dooley2017, Besla2018, Patel2018, Sawala2022}
\todo{Any additional citations?}.
It is also used to turn the kinematics of Local Group galaxies into orbital
histories, which is used to interpret their gas content (\todo{Geha, Putman
papers}) and star formation histories (\todo{Weisz, others} \citep{Weisz2011}).
However, as most of the mass in the Local Group is in dark matter distributed
over megaparsec scales, it is difficult to directly measure its total mass.

Given its utility in studies of the local universe, several methods have been
used to dynamically infer the mass of the Local Group.
Many of these techniques determine the individual masses of the MW and M31
independently, often via the dynamics of their satellites and stellar streams,
then combine them to get an estimate of the total LG
mass \citep{Watkins2010,Diaz2014,Patel2018} \todo{Eadie papers}.
Other techniques aim to more directly measure the mass of the Local Group en
masse, for example looking for Local Group analogs in cosmological simulations
based on stellar mass and kinematic criteria \citep{Zhai2020}, or by studying
the kinematics of Local Volume galaxies \citep{Penarrubia2014} \todo{check this
reference}.
One of the earliest methods utilized in this vein is the ``Timing Argument,''
which uses the fact that the local group galaxies (most often the MW and M31)
are bound and approaching pericenter in their relative orbit, but must have been
close enough over cosmic time to not be pulled apart by the Hubble flow. We
summarize the relevant details of the Timing Argument method in
Section~\ref{sec:timingarg}

The Timing Argument (using the MW and M31) uses the observed kinematics of M31
to model the relative orbit of the two galaxies as a Keplerian orbit.
Assuming Keplerian dynamics enables dynamically measuring the total mass of the
MW and M31 because of symmetries \todo{is it symmetries?} of the Kepler
equations.
However, recent studies of the dynamics of the MW and its satellites have
revealed that the infall of the Magellanic Clouds (MCs) is likely causing
significant distortions to the dark matter and stellar distribution in the MW
halo \todo{People, Conroy}, thus impacting the interpretation of observations of
the M31 position and velocity relative to the MW center of mass.
In particular, the inner MW and disk are likely being accelerated away from the
center of mass reference frame that would exist in the absence of the MCs
\citep{Gomez2015, Garavito-Camargo2021b}.

In past work, this (then unknown) velocity offset has been included in a Timing
Argument model of the Local Group by independently modeling the mass of the MW,
M31, and the MCs (labeled the LMC; \citealt{Penarrubia2016}).
However, the velocity offset of the inner MW with respect to the outer halo,
likely induced by the infall of the MCs, has been directly measured using tracer
stars in the stellar halo of the MW (the ``travel velocity'';
\citealt{Petersen2021}).
In this Article, we use this measurement of the travel velocity or reflex motion
of the inner Milky Way with respect to the outer halo (assumed to be the
reference frame that would exist in the absence of the MCs) in a Timing Argument
model to infer the mass of the Local Group using recent measurements of the
distance and proper motions of M31.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{The Timing Argument}
\label{sec:timingarg}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Following past work \citep[e.g.,][]{Lynden-Bell:1981, vdm2012, Penarrubia2016},
we assume that the orbital trajectories of the M31 and MW --- the Local Group
system --- over cosmic history are well-described by Keplerian orbits.
By assuming that the M31 and MW are gravitationally bound and were last at
closest approach in the early universe (i.e. the two galaxies have not yet
strongly interacted), we can then use the present-day kinematics of M31 to
estimate the total mass of the Local Group (i.e. using the ``Timing Argument'').

% \textbf{The dynamics of the M31-MW system can be approximated by simple Keplerian orbits.}
We largely follow the methodology and notation defined in
\citet{Penarrubia2016}, but the Timing Argument has been used in many other
studies \citep[e.g.,][]{stuff}.
% TODO: we have to put a list of TA references here so people don't get
% grumpy... but they will still be grumpy!
Briefly recapping the Timing Argument method, we assume that the dynamics of the
MW and M31 is dominated by the local gravitational potential of the Local Group
(LG) and therefore the Hubble flow can be neglected for computing the relative
orbits of the galaxies \citep[see, e.g.,][]{someone}.
% TODO: figure out most relevant citation for this!
Since we observe something close to the relative position and motion between M31
and the MW, we reduce the dynamics of the galaxies in the LG system to a single
Keplerian orbit that specifies the relative orbit between the galaxies and is
completely determined by four model parameters: the total mass of the Local
Group \mlg, the semi-major axis $a$, the eccentricity $e$, and the present value
of the eccentric anomaly $\eta$.

In terms of these four model parameters, the closed-form equations for relevant
two-body quantities like the separation between the masses $r$, the elapsed time
since last pericenter $t$, and the radial and tangential velocity components
\vrad\ and \vtan\ are given by:
\begin{align}
  r &= a \, (1-e\,\cos\eta) \label{eq:r} \\
  t &= \left( \frac{a^3}{GM} \right)^{1/2}(\eta-e\,\sin\eta) \label{eq:t} \\
  \vrad &= \left( \frac{GM}{a} \right)^{1/2} \frac{e\,\sin\eta}{1-e\,\cos\eta} \label{eq:vrad} \\
  \vtan &= \left( \frac{GM}{a} \right)^{1/2} \frac{\sqrt{1-e^2}}{1-e\,\cos\eta} \label{eq:vtan} \quad .
\end{align}
In our model, the separation $r$ is the distance between the centers of mass of
M31 and the MW, the time since last pericenter $t$ is the age of the Universe,
and (\vrad, \vtan) expresses the radial and tangential velocity components of
M31 relative to the MW center.

In a simpler universe where the MW and M31 are point masses and there are no
other massive bodies in the LG system, we could transform the observed
heliocentric sky position, distance, and velocity of M31 to a MW Galactocentric
reference frame and combine these with an estimate of the Hubble time to obtain
the four ``observables'' $(r, t, \vrad, \vtan)$ and then infer the four model
parameters $(\mlg, a, e, \eta)$ using Equations~\ref{eq:r}--\ref{eq:vtan}.
% \textbf{To compare our model predictions of the M31-MW system to the observed kinematics, we must translate these quantities into observables to constrain our model with observational data.}
To describe this ``classical'' Timing Argument approach in more detail and set
the stage for extending it, we adopt the notation of \citet{Penarrubia2016} in
which $\vel{A}{B}$ represents the velocity vector of A as measured in
the reference frame of B and $\pos{A}{B}$ represents the position vector of A as
measured from B.
With this notation, $\vel{A}{B} = -\vel{B}{A}$ and $\vel{A}{C} = \vel{A}{B} +
\vel{B}{C}$.
Thus, the position and velocity of M31 with respect to the center of mass of the
MW can be represented by $\pos{M31}{\mwbary}$ and $\vel{M31}{\mwbary}$
respectively, and the position and velocity of M31 as measured in a heliocentric
reference frame are given by
\begin{align}
  \pos{M31}{\odot} &= \pos{M31}{\mwbary} + \pos{\mwbary}{\odot} \label{eq:xoffset1}\\
  \vel{M31}{\odot} &= \vel{M31}{\mwbary} + \vel{\mwbary}{\odot} \label{eq:voffset1}\quad .
\end{align}
Here $\left|\pos{M31}{\mwbary}\right| = r$, $\vel{M31}{\mwbary}$ is determined
completely by the Keplerian model parameters (through \vrad\ and \vtan), and the
position and velocity of the center of mass of the MW as measured from the sun
are $\pos{\mwbary}{\odot}$ and $\vel{\mwbary}{\odot}$, respectively, and are
given by the adopted solar position and velocity in the Galaxy (the values we
adopt are given in Section~\ref{sec:datasets} below).

As noted above and in \citet{Penarrubia2016}, the dynamics of the MW--M31 system
is now thought to be more complex because of the infall of the LMC into the MW's
dark matter halo:
It is thought that the recent pericentric passage of the LMC has, to first
order, imparted a velocity boost on the disk and central regions of the MW,
shifting its position and velocity with respect to the mean position and
velocity of tracers in the outer MW \citep{Nico, Erkal, Petersen}.
This implies that we must account for additional terms in
Equations~\ref{eq:xoffset1} and \ref{eq:voffset1} to account for the reflex
motion of the MW disk with respect to the outer halo.
Thus, the observed position and velocity vector of M31 from the solar reference
frame is instead given by
\begin{align}
  \pos{M31}{\odot} &= \pos{M31}{\mwouter} + \pos{\mwouter}{\mwdisk}+\pos{\mwdisk}{\odot} \\
  \vel{M31}{\odot} &= \vel{M31}{\mwouter} + \vel{\mwouter}{\mwdisk}+\vel{\mwdisk}{\odot}
\end{align}
where ``\mwouter'' refers to a reference frame centered at and moving with the
center of mass of the outer MW halo and ``\mwdisk'' refers to a reference frame
centered at and moving with the center of the MW disk.
We assume that the outer MW halo frame is equivalent to the MW barycentric frame
in the simpler case where there is no LMC, or in other words we assume that the
outer MW halo has not yet had time to respond to the infall of the LMC.
We also assume that the sun, Galactic disk, and inner MW moved as a solid body
so that $\vel{\mwdisk}{\odot}$ and $\vel{\mwdisk}{\odot}$ are equivalent to the
solar position and velocity with respect to the Galactic center (as in
Equations~\ref{eq:xoffset1}--\ref{eq:voffset1}).
Figure~\ref{fig:schematic} shows a schematic of these different vectors --- all
drawn in a frame that is comoving with the \mwouter\ frame --- and a rough
illustration of the geometry we assume.

In what follows, we will assume that we have access to a direct measurement of
$\vel{\mwouter}{\mwdisk}$; This is different from \citet{Penarrubia2016} who
instead parametrize this term as a function of an additional parameter that sets
the mass ratio of the LMC and the MW.
We also assume that $\pos{\mwouter}{\mwdisk} \approx 0$ motivated by the fact
that this displacement is likely much smaller than the distance between the MW
and M31 $\pos{\mwouter}{\mwdisk} \ll r$ \citep[as expected from simulations,
e.g.,][]{Garavito-Camargo2021b}.

% APW: I'm not sure we need to go into detail about the coordinate system here
% info about coordinate system setup
% \textbf{We choose a coordinate system centered on the disk of the MW, where positive x is along the line of sight between the MW disk and the center of M31's disk, and positive y is in the direction of the tangential motion of M31.} Thus, the velocity vector of M31 in this Keplerian coordinate system is $(v_x, v_y, v_z) =(v_{rad},v_{tan},0)$, and $v_{rad}<0$ means M31 is moving towards the MW disk.

%%% Schematic %%%
\begin{figure*}[htb]
  \centering
  \includegraphics[width=0.8\columnwidth]{schematic_placeholder.png}
  \caption{
    Placeholder for whatever schematic we're going to end up creating
  }
  \label{fig:schematic}
\end{figure*}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Datasets}
\label{sec:datasets}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Key input into Timing Argument inferences of the Local Group mass are the
present position and velocity of M31 and the age of the universe (used in in
Equation~\ref{eq:t}).
Here we consider two compilations of data that provide this information to have
as comparisons.
The two datasets used in our analysis are summarized in Table~\ref{table:data}.
Briefly, ``Dataset 1'' comes from the measured proper motion of M31 and a
collection of other data used to constrain the mass of the Local Group via the
Timing Argument in~\citet{vdm2012}.
\todo{add note that we uses the full weighted pms from satellite kinematics and not just the HST.}
``Dataset 2'' is a compilation of more recent measurements, including a more
precise Cepheid-based distance measure to M31 \citep{Li2021} and updated proper
motions of M31 measured using data from \textit{Gaia} eDR3 \citep{Salomon2021}.
The \textit{Gaia}-based M31 proper motion measurement is slightly higher,
leading to an increased implied transverse velocity that will likely lead to a
higher inferred Local Group mass compared to the more radial orbit implied by
Dataset 1.

\begin{table*}
  \centering
  \begin{tabular}{lc|c}
    \hline\hline
                    & Dataset 1                     & Dataset 2 \\\hline
  $D$               &  $770 \pm 40~\kpc$ \citep{vdm2008}     &   $761\pm11~\kpc$ \citep{Li2021}        \\
  $v_{\rm rad}$     &     $-301 \pm 1~\kms$ \todo{Citation?}       &   $-301 \pm 1~\kms$        \\
  $(\mu_{\alpha^*},  \mu_\delta)$    & $(34.30 \pm 8.25, -20.22 \pm 7.71)~\muasyr$ \citep{vdm2012} & $(48.98 \pm 10.47, -36.85 \pm 8.03)~\muasyr$ \citep{Salomon2021}\\
  $\bs{v}_\odot$ & $(11.1, 251.54, 7.25)~\kms$ \todo{cite} & $(12.9, 245.6, 7.78)~\kms$ \citep{Drimmel2018}\\
  $t_{\rm peri}$ & $13.75 \pm 0.11~\Gyr$ \citep{Jarosik2011} & $13.801 \pm 0.024~\Gyr$ \todo{cite Planck18}\\
  %              &           &           \\
  %              &           &           \\
  \hline\hline

  \end{tabular}
  \caption{\label{table:data}
  Observational datasets used for comparison throughout analysis and their
  references (vdMG08 is \cite{vdm2008}) Each value is measured for M31 with
  respect to the sun. $D$ is the distance, $v_{\rm rad}$ is the radial velocity,
  $(\mu^*_{\alpha}, \mu_{\delta})$ are proper motions in RA cosdec and Dec, and
  (U$_{\rm pec}$, V$_{\rm pec}$+V$_0$, W$_{\rm pec}$) the solar motion with
  respect to the galactic center. $t_{\rm peri}$ is the time elapsed since the
  last pericenter of the M31 Keplerian orbit, which in this case is the age of
  the Universe.
  \apw{The references make the table spill over the page. I think we need to do
  references in footnotes instead?}
  }
\end{table*}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Bayesian Inference}
\label{sec:bayes}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

We construct a likelihood function for the observed, heliocentric position and
velocity of M31 and the time since last pericenter given the four parameters of
the Timing Argument model $(\mlg, a, e, \eta)$, assign prior probability
distribution functions (pdfs) for the parameters, and use these to compute the
posterior pdf over the parameters given the data.
In detail, we first use the four Timing Argument parameters to compute the
present day separation between the MW and M31, and the relative radial and
tangential velocities as defined in Equations~\ref{eq:r}--\ref{eq:vtan}.
These velocity components represent the relative velocity M31 would have as
observed from the barycenter of the MW--LMC subsystem; We then use the measured
``travel velocity'' of the MW disk $\vel{\mwouter}{\mwdisk}$ to compute the
relative velocity of M31 that would be observed from a frame moving with the
center of the Milky Way disk (i.e. a Galactocentric frame).
We finally then transform from this Galactocentric frame to a heliocentric
reference frame moving with the solar system barycenter (i.e. ICRS coordinates).
At this final stage, we must introduce an additional nuisance parameter $\alpha$
which represents the orientation of the MW--M31 orbital plane as it intersects
the tangent plane located at the sky position of M31 on the celestial sphere.
This is necessary because the Kepler equations only provide the magnitude of the
tangential velocity (i.e. Equation~\ref{eq:vtan}), but in order to compute
proper motion components we must also know the exact orientation of the M31
velocity vector.

We specify this model using the \texttt{Python} probabilistic programming
package \texttt{pymc3}~\citep{Salvatier2016} and our adopted prior pdfs are
summarized in Table~\ref{table:priors}.
We use the No-U-Turn Sampler (NUTS) \citep{gelman?} implemented in
\texttt{pymc3} to generate samples from this posterior pdf, given data from each
of the datasets defined in Table~\ref{table:data}.
We sample over the parameter Local Group mass $\mlg$, (true) present-day MW--M31
separation $r$, log eccentricity $\ln\left(1 - e\right)$, eccentric anomaly
$\eta$, and the orbital plane orientation nuisance parameter $\alpha$.
However, we set the priors as follows:
\begin{itemize}
  \item Mass of the Local Group $\mlg$: we use a broad, truncated normal
  distribution centered on a past measured value of the local group mass.
  \item Present MW--M31 separation $r$: we again use a broad, truncated normal
  distribution centered on past measurements of the distance to M31.
  % TODO: oops - we should center it on ~770 ot 750, not 700 kpc like we chose!
  \item Eccentricity $e$: we assume a uniform prior on eccentricity but sample
  in the transformed parameter $\ln(1-e)$ to improve the acceptance fraction
  when generating posterior samples.
  \item Eccentric anomaly $\eta$: we assume a uniform prior.
  \item Orbital plane orientation $\alpha$: we assume a uniform prior.
\end{itemize}

For each dataset, we run the sampler with 4 chains for 4000 tuning steps and
8000 draws.

% \begin{equation}
%   \mathcal{L}(| \boldsymbol{S})
% \end{equation}
% where $\boldsymbol{S} = ($\mlg$, a, e, \eta)$

% TODO: Letters have a 1 table max limit, so we might have to move the prior
% details into the list above. But we could always submit as a short regular
% paper instead of a letter...
\begin{table}
  \centering
  \begin{tabular}{lc}
  \hline\hline
  Prior  & Description \\\hline
  \mlg: $\mathcal{N}(4.5,3)\times10^{12}\Msun$ & Mass of the Local Group\\
  %
  $r$: $\mathcal{N}(700,100)$kpc & Distance from M31 to $\mwdisk$\\
  %
  $\ln(1-e)$: $\mathcal{U}$(-10,0) & Eccentricity (close to 1) \\
  %
  $\eta$: angle(0,2$\pi$)& Eccentric anomaly\\
  \multirow{2}{*}{$\alpha$: angle(0,2$\pi$)} & Angle between M31 orbital\\
  & pole and Galactocentric\\
  \hline\hline
  \end{tabular}
  \caption{\label{table:priors}Priors \kc{note: on \mlg and $r$, we also set bounds? how should I show those here? or should they go in the text?}}
\end{table}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Results: Local group mass estimates}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\label{sec:results}
\kc{Include the velocity vector of M31 from the halo frame?}

\begin{figure*}[htb]
  \centering
  \includegraphics[width=0.8\textwidth,trim=1.3cm 0.8cm 1.3cm 0cm,clip=true]
  {analyze-runs-contour.pdf}
  \caption{\label{fig:contour} 95\% confidence contours of sampled posterior
  distributions with three observational datasets for a subset of our model
  parameters: the total mass of the Local Group (\mlg)
  % , the distance between the Sun and M31 ($r$),
  and the eccentricity of the orbit of M31 about a fixed MW ($e$).
  The more radial orbit implied by the~\cite{vdm2012} \textit{HST} proper
  motions leads to a lower inferred \mlg\ and a higher
  eccentricity, while the larger \textit{Gaia} proper motions of
  ~\cite{Salomon2021} yield a more circular orbit, and thus a lower eccentricity
   and higher mass system.
  % A stationary MW disk is shown in the dotted contours, while our model,
  %which includes the reflex motion of the MW disk, is shown in solid lines.
  % The distributions for the separations are unchanged between models, as our
  % model does not implement a spatial shift to the location of the MW disk.
  \apw{I have some nitpicky requests! I added them as separate points after this. Sorry to be picky: I think this is the key figure, so want it to be very clear!}
  \apw{Change the MLG range to (1.5, 7) and add tick marks at 2, 3, 4, 5, 6, 7}
  \apw{Change the eccentriity range to (0.5, 1.01)}
  \apw{Check how the contours are made: they look like they go above e=1, but that shouldn't be possible!}
  \apw{More bins in the histogram to make it look smoother}
  }
\end{figure*}

% We use recent measurements of the present-day kinematics of M31 as observed from the solar system, updated measurements of the solar position and motion with respect to the Milky Way center, and a recent measurement of the velocity of the Milky Way disk with respect to the outer stellar halo to measure the mass of the Local Group using observed kinematics of M31.

We use a Bayesian model to place constraints on the mass of the Local Group and the distance between M31 and the Sun using the Timing Argument. Our model of the Local Group includes the reflex motion of the Milky Way disk and results in new constrains on the mass of the Local Group to 4.69$\pm0.71 \times 10^{12}~\Msun$.

% this will maybe go in discussion?
Previous studies that have used the Timing Argument to constrain the mass of the
Local Group have found a range of masses.
~\cite{vdm2012} used the timing argument with Dataset 1 and derived a mass of
$4.27\pm 0.53\times 10^{12}~\Msun$) \kc{note: our value of \mlg is $\sim.3 \times 10^{12}~\Msun$ higher than found in vdm2012 with the same set of data with no travel velocity. probably just in implementation of mcmc or something?}.
~\cite{Penarrubia2016} finds a Local Group mass of ($\sim2.64\pm0.4\times
10^{12}~\Msun$) which is significantly lower than our expectations, although this
constraint combines the observed kinematics of 35 Local Volume galaxies in
addition to the dynamics of the M31--MW system.
Each of the Local Volume Galaxies is fit to a radial Keplerian orbital model.
However, inclusion of any transverse motion will increase the inferred total
mass of the system, so it is likely the assumption of radial orbits leads to
an underestimate of the mass of the Local Group with LV galaxies only.
Including the dynamics of the M31--MW system increased their recovered
total mass by $0.6\times10^{12}~\Msun$.



We found that, for both considered datasets, our model prefers lower Local Group masses and a lower eccentricity orbit compared to models that do not include MW disk reflex motion. Fig.~\ref{fig:contour} shows the 95\% contours from the sampled posterior PDFs of the distance to M31, the eccentricity of the orbit of M31 with a fixed MW, and the inferred Local Group mass. Arrows in the bottom left panel of the corner plot indicate the shift to lower masses and eccentricities when introducing the reflex motion of the MW.

The direction of the motion of the disk is directly tied to the behavior of the inferred mass of the Local Group. In this case, the orbit of the LMC and location of the LMC at pericenter are in the same region of the sky as M31 such that the radial component of motion is in the direction of M31. Thus, the observed radial velocity of M31 will be higher than for an unperturbed MW halo. Since $-v_{rad}\propto M^{1/2}$ for an infalling system, a smaller (but still negative) radial velocity will yield a lower Local Group mass.

The eccentricity decreases significantly for Dataset 2 compared to Dataset 1, due to the larger measured proper motions of Dataset 2.  Additionally, a smaller radial velocity corresponds to a lower eccentricity for a fixed mass and distance, which can be seen in the bottom right panel of~\ref{fig:contour}.

Constraints on the distance to M31 remain roughly unchanged for both datasets, primarily because our model does not introduce a physical displacement of the MW disk, since we assume the motion of the disk over the past XX Myr since the LMC achieved pericenter is negligible compared to the separation between M31 and the MW. Thus, the inclusion of the reflex motion of the disk in our model does not affect constraints on the distance to M31.


% bit about the stellar halo tracers and different distances etc
\cite{Garavito-Camargo2021b} showed that stellar halo tracers at different distances from the MW disk center may result in different measured travel velocities, and it's likely that the current measurements on $v_{travel}$ of 32km/s are just a lower bound on the actual reflex motion of the disk. In Fig.~\ref{fig:mvsv}, we show that for increasing travel velocity magnitudes, the mass of the Local Group from the Timing Argument steadily decreases. Thus, future measurements of the travel velocity of the disk will likely result in a lower inferred Local Group mass. Vertical lines show the travel velocities that are expected for three tracer distances in simulations from~\cite{Garavito-Camargo2021b}. \kc{why does the mass level off after 80kpc / 70km/s? }

% bit about PM improvement
Of all our observational data, the proper motions have the largest relative errorbars. In order to determine how improved constraints on the proper motions from future Gaia data releases would impact Timing Argument constraints on the Local Group mass, we redid our analysis as a function of the fractional improvement in proper motion errors.
We find that as proper motion measurements improve by a factor of $\sim2$, the constraints on the Local Group mass from the timing argument will improve by a factor of more than 1.5. These results are compiled in Fig.~\ref{fig:mvspm}.




\begin{figure}[htb]
    \centering
    \includegraphics[width=\columnwidth]{analyze-runs-MvV.pdf}
    \caption{\label{fig:mvsv}
    Mean inferred Local Group mass as a function of travel velocity
    magnitude of the MW disk.
    The larger \textit{Gaia} proper motions (yellow) lead to higher transverse
    motion and thus higher mass than either of the \textit{HST} proper motion
    datasets (pink and purple), though they display the same general trends with increasing travel velocity.
    The vertical lines represent simulated travel velocities for
    stellar tracers at different distances in~\cite{Garavito-Camargo2021b}.
    The mean Local Group mass corresponding to the observed travel velocity
    from~\cite{Petersen2021} of 32km/s (triangle points) and the 1-$\sigma$
    spread on the mass is shown for comparison.
    \textbf{The inclusion of the reflex motion of the MW disk systematically
    lowers the inferred mass of the Local Group} regardless of observational
    dataset.
    \kc{make sense of the leveling off at 70km/s.}
    \kc{also maybe add to x values of points to put them next to each other?
    instead of overlapping?}
    }
  \end{figure}

\begin{figure}[htb]
    \centering
    \includegraphics[width=\columnwidth]{analyze-runs-deltaMvsPM.pdf}
    \caption{\label{fig:mvspm} Improvement in the inferred Local Group mass as a function of fractional improvement in proper motion errors.
    The standard deviation in the mass decreases with decreasing proper motion
    error, and in particular, decrease by a factor of $\sim2.5$ for PMs that are
    4 times smaller than in Dataset 2.
    \textbf{As future \textit{Gaia} data releases provide improved proper motion errors, constraints on the Local Group mass from the Timing Argument can
    improve by a factor of $>$2.}
    }
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Summary and Discussion}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\label{sec:discussion}
In this Letter, we use the Timing Argument to constrain the mass of the Local
Group by
simplifying the dynamics of the MW--M31 pair to a Keplerian orbital model and
given two compilations of data for the position and velocity of M31.
However, these observations have not accounted for the reflex motion of the
Milky Way disk with respect to the outer halo, and thus previous Timing
constraints on
the LG mass do not include the crucial dynamical effect of the velocity boost
of the disk.

We show that introducing the travel velocity of the MW disk into the Keplerian
model lowers the inferred Local Group mass from the Timing Argument for two 6D
M31 datasets.
We provide an updated constraint on the mass of the Local Group of
4.69$\pm\times$0.71 $10^{12}~\Msun$ using recent \textit{Gaia} eDR3 proper
motions~\citep{Salomon2021}, precise Cepheid distance measurements
~\citep{Li2021}, and assuming a disk travel velocity of 32km/s from
~\cite{Petersen2021}, and show that an increase in the travel velocity of the
disk will result in even lower inferred LG masses.

\subsection{Cosmological implications}
\begin{table*}
  \centering
  \begin{tabular}{clc|c}
    \hline\hline
    Mass & Method & Result ($ 10^{12}~\Msun$ ) & Citation \\\hline
    \multirow{7}{*}{\mlg}  &{LV Galaxies + Timing Argument} & {2.64$\pm0.4$} & \cite{Penarrubia2016} \\
    &{Timing only} & {4.27$\pm$0.45} & \cite{vdm2012} \\
    &{Timing (3D + cosmic bias and scatter)} & {4.93$\pm$1.63} & \cite{vdm2012} \\
    &Timing (radial + cosmo sim calibration)  & $5.27$& \cite{LiWhite2008} \\
    &Timing & $3.6$ & \cite{Lynden-Bell:1981} \\
    & Cosmo Sims & 4.4$^{+2.4}_{-1.5}$ & \cite{Zhai2020}\\
    & LG Dynamics &$2.5\pm0.4$ & \cite{Diaz2014}\\
    %  &  &  \\
    \hline
    \multirow{3}{*}{\mmto}& Kinematics of M31 Sats & $1.4 \pm 0.4$ ($<$300 kpc) & \cite{Watkins2010}\\
    & Cosmo Sims & 2.5$^{+1.3}_{-1.1}$ & \cite{Zhai2020}\\
    & LG Dynamics &$1.7\pm0.3$ & \cite{Diaz2014}\\
    \hline
    \multirow{4}{*}{\mmw}&  Kinematics of LG sats & $1.4 \pm 0.3$ ($<$300 kpc) & \cite{Watkins2010}\\
    & Cosmo Sims & 1.5$^{+1.4}_{-0.7}$ & \cite{Zhai2020} \\
    & LG Dynamics &$0.8\pm0.5$ & \cite{Diaz2014}\\
    & MW Sats & $0.96^{+0.29}_{-0.28}$ & \cite{Patel2017}\\
  \hline\hline
  \end{tabular}
  \caption{\label{table:masses}Can remove this, this is just to keep me sane}
\end{table*}
Previous uses of the Timing Argument have placed constraints on the mass of the Local Group

By including reflex motion, we move in the direction of the expected summed masses of the Milky Way and M31 which is good.

How does the mass that we found compare to mass estimates from other means?
- like hubble flow constraints, previous timing argument, previous MW--M31 measurements, etc.



If our mass is higher, what does that mean?
If our mass is lower, what does that mean?
What does this high mass mean to the Local Group? What about to the
constituents?

What is context for mergers and M31 and why they might be
related to the Local Group mass?


Our findings of a high mass Local Group are consistent with findings that the
mass of M31 is XXbig and the MW is $1-1.5\times10^{12}~\Msun$~\citep{??}.
However, this high group mass also has cosmological implications.
A high Local Group mass could also be consistent with tk that propose that M31
has undergone recent (XX Gyrs) major? accretion events with other massive
subhalos, resulting in morphological features like the Giant Southern Stream and
XX (what are other M31 things that indicate recent interactions? Do we think
much about M32? )

\subsection{Inclusion of reflex motion in dynamics of the Local Group}
The inclusion of the reflex motion of the Milky Way disk can result in up to
$1\times10^{12}$ difference in the estimated mass of the Local Group, which
means that by not accounting for this motion, we could get measurements of the
Local group mass that are overestimated by 20-25\%.
Other dynamical interactions within the Local Group will also be affected by
the reflex motion of the disk. (What is the distribution of satellite velocities
about the MW now and w reflex motion? Cause should there maybe be an excess of
-vrad satellites in the MW halo? )


\subsection{Expectations for future observations.}
\kc{Adrian!}

Do we expect Gaia DR3 proper motions to improve by a factor of ~4?
This would provide the tightest constraints on the Local Group mass from the
Timing Argument!

\subsection{The M31--M33 system}
We do not account for the effects of reflex motion of M31 due to
uncertainties in both its interaction history and the orbital history of
M33.
A first infall scenario for M33 would rule out the possibility of a
strong reflex response resulting due to a close pericentric passage.
On the other hand, M31 has likely experienced significant disturbances, as
evidenced by the double nucleus and Giant Southern Stream,
which may have been resulted in a substantial reflex motion.
Thus, we elect to disregard the effects of an M31 reflex motion.


\subsection{Other?}
Concluding remarks

\appendix
Currently, appendix only includes the corner plots for all of the 5 model parameters for each of the three datasets.
\begin{figure*}[htb]
  \centering
  \includegraphics[width=0.8\columnwidth]{analyze-runs-all-vdm2012.pdf}
  \caption{\label{fig:contour-vdm}
  }
\end{figure*}

\begin{figure}[htb]
  \centering
  \includegraphics[width=0.8\columnwidth]{analyze-runs-all-Dataset3.pdf}
  \caption{\label{fig:contour-dataset3}
  }
\end{figure}

\begin{figure*}[htb]
  \centering
  \includegraphics[width=0.8\columnwidth]{analyze-runs-all-fiducial2021.pdf}
  \caption{\label{fig:contour-fiducial}
  }
\end{figure*}

% \software{
%     Astropy \citep{astropy, astropy:2018},
%     gala \citep{gala},
%     IPython \citep{ipython},
%     numpy \citep{numpy},
%     pymc3 \citep{Salvatier2016},
%     scipy \citep{scipy}
% }

\bibliography{refs}{}
\bibliographystyle{aasjournal}

\end{document}
